<!DOCTYPE html>
<html>
<head>
    <title>{{ p.name }} - Details</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <button onclick="toggleDarkMode()" id="dark-mode-toggle">üåô Dark Mode</button>

    <div class="container">
		<div class="pokemon-header">
			<div class="pokemon-id">#{{ "%03d"|format(p.id) }}</div>
			<div class="sprite-pair">
				<img src="{{ p.sprite }}" alt="{{ p.name }} (normal)" class="pokemon-img extra-large">
				<img src="{{ p.shiny_sprite }}" alt="{{ p.name }} (shiny)" class="pokemon-img extra-large">
			</div>
		</div>

		<h1 class="pokemon-name">{{ p.name }}</h1>

		<div class="type-container large">
			{% for t in p.types %}
				<span class="type-label type-{{ t }} large">{{ t }}</span>
			{% endfor %}
		</div>

		<div class="ability-tags">
			{% for ab in p.abilities %}
				<span class="type-label type-{{ p.types[0]|lower }}">{{ ab }}</span>
			{% endfor %}
		</div>

        <div class="description-box">
            <p>{{ p.description }}</p>
        </div>

		<div class="stats-info-wrapper">
			<div class="stats-bar">
				{% for stat, value in p.stats.items() %}
					<div class="stat-row">
						<span class="stat-name">{{ stat.capitalize() }}</span>
						<div class="stat-bar-bg">
							<div class="stat-bar-fill"
								style="width: {{ (value / 256) * 100 }}%; background-color: {{ stat_color(value) }}">
							</div>
						</div>
						<span class="stat-value">{{ value }}</span>
					</div>
				{% endfor %}
			</div>

			<div class="info-table">
				<table>
					<tr><td>Height</td><td>{{ p.height }} dm</td></tr>
					<tr><td>Weight</td><td>{{ p.weight }} hg</td></tr>
					<tr><td>Base XP</td><td>{{ p.base_experience }}</td></tr>
					<tr><td>Egg Groups</td><td>{{ p.egg_groups | join(', ') }}</td></tr>
				</table>
			</div>
		</div>

        {% if p.forms %}
        <div class="section-title">Forms</div>
        <div class="horizontal-scroll">
            {% for form in p.forms %}
                <a href="/pokemon/{{ form.name | lower }}" class="button-card">
                    <img src="{{ form.sprite }}" alt="{{ form.name }}">
                    <div>
                        {{ form.name }}{% if form.is_default %}<br>(Default){% endif %}
                    </div>
                </a>
            {% endfor %}
        </div>
        {% endif %}

        {% if p.evolutions %}
        <div class="section-title">Evolution Line</div>
        <div class="horizontal-scroll">
            {% for evo in p.evolutions %}
                <a href="/pokemon/{{ evo.name | lower }}" class="button-card">
                    <img src="{{ evo.sprite }}" alt="{{ evo.name }}">
                    <div>{{ evo.name }}</div>
                </a>
            {% endfor %}
        </div>
        {% endif %}

        <div class="back-link">
            <a href="/pokedex" class="button-link">‚Üê Back to Pok√©dex</a>
        </div>
    </div>

    <script>
        function toggleDarkMode() {
            const body = document.body;
            body.classList.toggle("dark-mode");
            body.classList.toggle("dark");
            localStorage.setItem("theme", body.classList.contains("dark-mode") || body.classList.contains("dark") ? "dark" : "light");
        }

        window.onload = function () {
            const savedTheme = localStorage.getItem("theme");
            if (savedTheme === "dark") {
                document.body.classList.add("dark-mode", "dark");
            }
        };
    </script>
</body>
</html>